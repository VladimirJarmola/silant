{% extends "main/base.html" %}

{% load static %}
{% load cars_tags %}

{% block cars %}
    <div class="btn-toolbar mb-2" role="toolbar" aria-label="Toolbar with button groups">
        <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
        <label class="btn btn-outline-primary me-2" for="btnradio1">Общая информация</label>

        <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
        <label class="btn btn-outline-primary me-2" for="btnradio2">Техническое обслуживание</label>

        <input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off">
        <label class="btn btn-outline-primary me-2" for="btnradio3">Рекламации</label>
    </div>

    <div class="d-flex justify-content-center mb-2">
        <!-- Форма сортировки -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Сортировка
            </button>

            <form action="{% url "cars:cars" %}" method="get" class="dropdown-menu" data-bs-theme="white">
                
                <div class="form-check mx-3">
                    <input class="form-check-input" type="radio" name="order_by" id="flexRadioDefault1" value="default" checked>
                    <label class="form-check-label fontSizeBtn" for="flexRadioDefault1">
                        По возрастанию даты отгрузки с завода
                    </label>
                </div>

                <div class="form-check mx-3">
                    <input class="form-check-input" type="radio" name="order_by" id="flexRadioDefault2" value="price">
                    <label class="form-check-label fontSizeBtn" for="flexRadioDefault2">
                    По убыванию даты отгрузки с завода
                    </label>
                </div>

                <button type="submit" class="btn btn-primary btn-sm mx-3 mt-3">Применить</button>
            </form>
        </div>

    <!-- Фильтрация по модели техники -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Модель техники
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:cars" %}">Все модели</a></li>
                <li><hr class="dropdown-divider"></li>
                {% tag_vehicle_models as vehicle_models %}
                {% for model in vehicle_models %}
                    <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:vehicle" model.id %}">{{ model.name }}</a></li>
                {% endfor %}
            </ul>
        </div>

        <!-- Фильтрация по модели двигателя -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Модель двигателя
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:cars" %}">Все модели</a></li>
                <li><hr class="dropdown-divider"></li>
                {% tag_engine_models as engine_models %}
                {% for model in engine_models %}
                    <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:engine" model.id %}">{{ model.name }}</a></li>
                {% endfor %}
            </ul>
        </div>

        <!-- Фильтрация по модели трансмиссии -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Модель трансмиссии
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:cars" %}">Все модели</a></li>
                <li><hr class="dropdown-divider"></li>
                {% tag_transmission_models as transmission_models %}
                {% for model in transmission_models %}
                    <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:transmission" model.id %}">{{ model.name }}</a></li>
                {% endfor %}
            </ul>
        </div>

        <!-- Фильтрация по модели ведущего моста -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Модель ведущего моста
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:cars" %}">Все модели</a></li>
                <li><hr class="dropdown-divider"></li>
                {% tag_drive_axle_models as drive_axle_models %}
                {% for model in drive_axle_models %}
                    <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:drive_axle" model.id %}">{{ model.name }}</a></li>
                {% endfor %}
            </ul>
        </div>

        <!-- Фильтрация по модели управляемого моста -->
        <div class="dropdown mb-2 me-2">
            <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Модель управляемого моста
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:cars" %}">Все модели</a></li>
                <li><hr class="dropdown-divider"></li>
                {% tag_steering_axle_models as steering_axle_models %}
                {% for model in steering_axle_models %}
                    <li><a class="dropdown-item fontSizeBtn" href="{% url "cars:steering_axle" model.id %}">{{ model.name }}</a></li>
                {% endfor %}
            </ul>
        </div>
    </div>
    
    <table class="table table-striped">
        <thead class='myTHead'>
        <tr>
            <th scope="col">Зав. № машины</th>
            <th scope="col">Модель техники</th>
            <th scope="col">Модель двигателя</th>
            <th scope="col">Зав. № двигателя</th>
            <th scope="col">Модель трансмиссии</th>
            <th scope="col">Зав. № трансмиссии</th>
            <th scope="col">Модель ведущего моста</th>
            <th scope="col">Зав. № ведущего моста</th>
            <th scope="col">Модель управляемого моста</th>
            <th scope="col">Зав. № управляемого моста</th>
            <th scope="col">Договор поставки №, дата</th>
            <th scope="col">Дата отгрузки с завода</th>
            <th scope="col">Грузополучатель (конечный потребитель)</th>
            <th scope="col">Адрес поставки (эксплуатации)</th>
            <th scope="col">Комплектация (доп. опции)</th>
            <th scope="col">Клиент</th>
            <th scope="col">Сервисная компания</th>
        </tr>
        </thead>
        <tbody>
        {% for car in cars %}
        
            <tr onclick="window.location.href='{% url "cars:car" car.id %}'; return false">
                
                    <td>{{ car.serial_number_vehicle }}</td>
                    <td>{{ car.vehicle_model }}</td>
                    <td>{{ car.engine_model }}</td>
                    <td>{{ car.serial_number_of_the_engine }}</td>
                    <td>{{ car.transmission_model }}</td>
                    <td>{{ car.serial_number_of_the_transmission }}</td>
                    <td>{{ car.drive_axle_model }}</td>
                    <td>{{ car.drive_axle_serial_number }}</td>
                    <td>{{ car.steering_axle_model }}</td>
                    <td>{{ car.serial_number_of_the_steered_axle }}</td>
                    <td>{{ car.supply_contract }}</td>
                    <td>{{ car.date_shipped_from_factory }}</td>
                    <td>{{ car.consignee }}</td>
                    <td>{{ car.delivery_address }}</td>
                    <td>{{ car.equipment|truncatechars:40 }}</td>
                    <td>{{ car.client }}</td>
                    <td>{{ car.service_company }}</td>
                
            </tr>
        
        {% endfor %}

        </tbody>
    </table>

    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
            <li class="page-item {% if not cars.has_previous %}disabled{% endif %}">
                <a class="page-link" href="{% if cars.has_previous %}?page={{cars.previous_page_number}}
                {% else %}
                    #
                {% endif %}">Назад</a>
            </li>

        {% for page in cars.paginator.page_range %}
            {% if page >= cars.number|add:-2 and page <= cars.number|add:2 %}
                <li class="page-item {% if cars.number == page %} active {% endif %}">
                    <a class="page-link" href="?page={{page}}">{{ page }}</a>
                </li>
            {% endif %}
        {% endfor %}
          

          <li class="page-item {% if not cars.has_next %}disabled{% endif %}">
            <a class="page-link" href="{% if cars.has_next %}
                ?page={{cars.next_page_number}}
            {% else %}
                #
            {% endif %}">Вперед</a>
          </li>
        </ul>
      </nav>
{% endblock %}

{% block main_footer %}
    <footer class="container py-3 my-4 ">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3"></ul>
        <div class='footerText'>
            <p class="text-center text-body-secondary">+7-8352-20-12-09, telegram</p>
            <p class="text-center text-body-secondary">&copy; 2024 Мой Силант</p>
        </div>
    </footer>
{% endblock %}